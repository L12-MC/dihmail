{% extends "base.html" %}
{% block title %}Send Message - dihmail{% endblock %}
{% block content %}
<div class="send-container">
    <h2>Compose</h2>
    <form method="POST" enctype="multipart/form-data">
        <div class="form-group">
            <label for="recipient">Recipient Address:</label>
            <input type="text" id="recipient" name="recipient" placeholder="example:dih:domain.com" required>
            <small>Format: &lt;local&gt;:dih:domain.com</small>
        </div>
        <div class="form-group">
            <label>Rich Text:</label>
            <div id="editor" style="background:#121212;color:#e0e0e0;min-height:160px;border:1px solid #333;border-radius:6px;padding:8px;"></div>
            <input type="hidden" name="rich_html" id="rich_html">
            <small>You can format text; if left empty, plain textarea below is used.</small>
        </div>
        <div class="form-group">
            <label for="message">Plain Fallback:</label>
            <textarea id="message" name="message" rows="4"></textarea>
        </div>
        <div class="form-group">
            <label for="attachments">Attachments:</label>
            <input type="file" id="attachments" name="attachments" multiple>
            <small>Optional: files are encrypted individually.</small>
        </div>
        <button type="submit" class="btn-primary">Send Encrypted Message</button>
        <a href="{{ url_for('dashboard') }}" class="btn-secondary">Cancel</a>
    </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">
<script>
  var quill = new Quill('#editor', { theme: 'snow' });
  document.querySelector('form').addEventListener('submit', function(){
     document.getElementById('rich_html').value = quill.root.innerHTML.trim();
  });
</script>
{% endblock %}
